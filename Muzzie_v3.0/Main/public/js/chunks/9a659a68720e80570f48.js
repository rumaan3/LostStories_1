(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{241:function(t,s,e){var i=e(466);"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};e(6)(i,n);i.locals&&(t.exports=i.locals)},465:function(t,s,e){"use strict";e(241)},466:function(t,s,e){(t.exports=e(5)(!1)).push([t.i,".chat-wrapper{position:absolute;left:0;right:0;top:0;bottom:0;background-color:var(--light-theme-panel-bg-color);display:flex;flex-direction:column}.chat-header{display:flex;align-items:center;padding:.4em 1em;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.chat-header .back{margin-right:1rem;width:.8em}.chat-header .dots{justify-self:flex-end}.chat-header .friend-name{max-width:100%;flex-grow:2}.chat-header .friend-cover{margin-right:.5em}.chat-header .friend-cover img{width:2em;border-radius:50%}.chat-body{overflow-y:auto;padding:.4em 1em;flex-grow:5}.chat-footer{padding:0 1rem .5em}.chat-footer form{position:relative}.chat-footer form .chat-input{position:relative;height:2.25em;width:100%}.chat-footer form .chat-input .error{position:absolute;top:0;left:0;right:0;bottom:0;opacity:.95;z-index:5}.chat-footer form .chat-input input{width:100%;color:#000;background-color:#e9e9e9;border-radius:5px;padding:.4em 1rem}.chat-footer form .send-icon{position:absolute;right:.6em;top:50%;z-index:4;transform:translateY(-50%)}.msg{margin:1em 0;position:relative;word-break:break-word}.msg .msg-time{text-align:center;margin-bottom:1.3em;font-size:.6em}.msg .seen{position:absolute;top:105%;left:5%;font-size:.85em;opacity:.65}.msg-text{background-color:#a7a7a7;border-radius:17px;padding:.3em .8em;color:#fff;display:flex;width:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.msg-text .text{align-self:flex-start}.my-msg{text-align:right}.my-msg .seen{left:90%}.my-msg .msg-text{background-color:var(--color-primary);color:#fff;margin-left:auto}.my-msg .msg-text .text{align-self:flex-end}.player--dark .chat-wrapper{background-color:var(--dark-theme-panel-bg-color)}",""])},706:function(t,s,e){"use strict";e.r(s);var i={props:["friend"],data:function(){return{chats:[],message:null,isTyping:!1,chatMenuDialog:!1,blockFriendConfirmationDialog:!1}},computed:{session:function(){return this.friend.session}},methods:{send:function(){this.message&&(this.pushToChats(this.message),axios.post("/api/send/".concat(this.friend.session.id),{content:this.message,to_user:this.friend.id}),this.friend.session.last_message[0]||(this.friend.session.last_message[0]={}),this.$store.getters.getSettings.ga4&&this.$store.getters.getSettings.analytics_fileUpload_event&&emitAnalyticsEvent({action:"Chat Message",category:"message",label:this.message}),this.friend.session.last_message[0].content=this.$t("You")+": "+this.message,this.message=null)},pushToChats:function(t){this.chats.push({message:t,type:0,read_at:null,sent_at:this.$t("Just Now")})},close:function(){this.$emit("close")},clear:function(){var t=this;axios.post("/api/sessions/".concat(this.friend.session.id,"/clear")).then((function(){return t.chats=[]}))},block:function(){this.session.block||(this.session.block=!0,this.session.blocked_by=this.$store.getters.getUser.id,this.chatMenuDialog=!this.chatMenuDialog,axios.post("/api/sessions/".concat(this.friend.session.id,"/block")))},unblock:function(){this.session.blocked_by==this.$store.getters.getUser.id&&(this.session.block=!1,this.session.blocked_by=null,axios.post("/api/sessions/".concat(this.friend.session.id,"/unblock"))),this.chatMenuDialog=!this.chatMenuDialog},getAllMessages:function(){var t=this;axios.post("/api/sessions/".concat(this.friend.session.id,"/chats")).then((function(s){return t.chats=s.data}))},read:function(){axios.post("/api/sessions/".concat(this.friend.session.id,"/read"))}},created:function(){var t=this;this.read(),this.getAllMessages(),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("PrivateChatEvent",(function(s){t.friend.session.open&&t.read(),t.chats.push({message:s.content,type:1,sent_at:t.$t("Just Now")}),t.friend.session.last_message[0].content=s.content})),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("MsgReadEvent",(function(s){return t.chats.forEach((function(t){return t.id==s.chat.id?t.read_at=s.chat.read_at:""}))})),window.Echo.private("Chat.".concat(this.friend.session.id)).listen("BlockEvent",(function(s){return t.session.block=s.blocked,t.session.blocked_by=s.blocked_by})),window.Echo.private("Chat.".concat(this.friend.session.id)).listenForWhisper("typing",(function(s){t.isTyping=!0,setTimeout((function(){t.isTyping=!1}),2e3)}))}},n=(e(465),e(0)),o=e(1),a=e.n(o),r=e(81),c=e(105),l=e(3),d=e(564),h=e(75),m=e(153),f=e(113),g=e(157),u=Object(n.a)(i,(function(){var t=this,s=t.$createElement,e=t._self._c||s;return t.friend?e("div",{staticClass:"chat-wrapper"},[e("div",{staticClass:"chat-header"},[e("div",{staticClass:"back pointer",on:{click:function(s){return s.preventDefault(),t.close(s)}}},[e("v-icon",[t._v("$vuetify.icons.chevron-left")])],1),t._v(" "),e("div",{staticClass:"friend-cover"},[e("img",{attrs:{src:t.friend.avatar,alt:""}})]),t._v(" "),e("div",{staticClass:"friend-name max-1-lines"},[t._v("\n      "+t._s(t.friend.name)+"\n    ")]),t._v(" "),e("div",{staticClass:"dots"},[e("v-menu",{attrs:{left:"",bottom:"","position-y":125,"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(s){var i=s.on,n=s.attrs;return[e("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",n,!1),i),[e("v-icon",{attrs:{small:""}},[t._v("$vuetify.icons.dots-horizontal")])],1)]}}],null,!1,4209589308)},[t._v(" "),e("v-list",{staticClass:"list",class:{"dark-background":t.$vuetify.theme.dark}},[t.session.blocked_by?e("v-list-item",{on:{click:t.unblock}},[t._v("\n           "+t._s(t.$t("Unblock"))+"\n        ")]):e("v-list-item",{on:{click:t.block}},[t._v("\n           "+t._s(t.$t("Block"))+"\n        ")])],1)],1),t._v(" "),e("v-dialog",{attrs:{"max-width":"400"},model:{value:t.blockFriendConfirmationDialog,callback:function(s){t.blockFriendConfirmationDialog=s},expression:"blockFriendConfirmationDialog"}},[e("v-card",[t._v("\n          "+t._s(t.$t("Are you sure you wanna block"))+" "+t._s(t.friend.name)+" ?\n          "),e("v-card-actions",[e("v-btn",{attrs:{color:"error",text:""},on:{click:t.block}},[t._v(t._s(t.$t("Block")))]),t._v(" "),e("v-btn",{attrs:{text:""},on:{click:function(s){t.blockFriendConfirmationDialog=!1}}},[t._v(t._s(t.$t("Cancel")))])],1)],1)],1)],1)]),t._v(" "),e("div",{staticClass:"chat-body"},t._l(t.chats,(function(s,i){return e("div",{key:s.id,staticClass:"msg",class:{"my-msg":0==s.type}},[e("div",{directives:[{name:"show",rawName:"v-show",value:i==t.chats.length-1,expression:"i == chats.length - 1"}],staticClass:"msg-time"},[t._v("\n        "+t._s(s.send_at)+"\n      ")]),t._v(" "),e("div",{staticClass:"msg-text"},[e("div",{staticClass:"text"},[t._v("\n          "+t._s(s.message)+"\n        ")])]),t._v(" "),i==t.chats.length-1?e("div",{directives:[{name:"show",rawName:"v-show",value:s.read_at,expression:"chat.read_at"}],staticClass:"seen"},[t._v("\n        "+t._s(t.$t("Seen"))+"\n      ")]):t._e()])})),0),t._v(" "),e("div",{staticClass:"chat-footer"},[e("form",{on:{submit:function(s){return s.preventDefault(),t.send(s)}}},[e("div",{staticClass:"chat-input text-center"},[t.session.block?[t.session.blocked_by==t.$store.getters.getUser.id?e("v-btn",{staticClass:"error",attrs:{block:""},on:{click:t.unblock}},[t._v(t._s(t.$t("Unblock")))]):e("span",[t._v(t._s(t.$t("You can no longer chat with this person.")))])]:[e("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control m_input",attrs:{type:"text",placeholder:"Write your message here"},domProps:{value:t.message},on:{input:function(s){s.target.composing||(t.message=s.target.value)}}}),t._v(" "),e("div",{staticClass:"send-icon pointer",on:{click:t.send}},[e("img",{staticClass:"svg-image",attrs:{src:"/svg/send.svg",alt:""}})])]],2)])])]):t._e()}),[],!1,null,null,null);s.default=u.exports;a()(u,{VBtn:r.a,VCard:c.a,VCardActions:l.a,VDialog:d.a,VIcon:h.a,VList:m.a,VListItem:f.a,VMenu:g.a})}}]);